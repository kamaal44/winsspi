from winsspi.sspi import KerberosSSPI, LDAP3NTLMSSPI

"""
target = 'WIN2019AD'
ksspi = KerberosSSPI()
ksspi.authGSSClientInit(target)
ksspi.authGSSClientStep(None)
key = ksspi.get_session_key()
print(key)
"""

data = bytes.fromhex('4e544c4d53535000020000000800080038000000358289e2172e684866b42093000000000000000088008800400000000a0063450000000f540045005300540002000800540045005300540001001200570049004e003200300031003900410044000400120074006500730074002e0063006f007200700003002600570049004e003200300031003900410044002e0074006500730074002e0063006f00720070000500120074006500730074002e0063006f007200700007000800d6e08e05d612d50100000000')
ksspi = LDAP3NTLMSSPI()
ksspi.create_negotiate_message()
ksspi.parse_challenge_message(data)
key = ksspi.get_session_key()
print(key)
